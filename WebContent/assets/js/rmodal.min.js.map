{"version":3,"sources":["rmodal.js"],"names":["let","is","obj","type","Object","prototype","toString","call","toLowerCase","addClass","el","cls","arr","className","split","filter","c","length","removeClass","join","RModal","opts","this","opened","bodyClass","dialogClass","dialogOpenClass","dialogCloseClass","focus","focusElements","escapeClose","content","closeTimeout","keys","forEach","key","undefined","this$1","overlay","dialog","querySelector","open","beforeOpen","_doOpen","document","body","style","display","focusOutElement","activeElement","afterOpen","close","beforeClose","_doClose","afterClose","setTimeout","html","innerHTML","elements","selector","fallback","window","navigator","appVersion","indexOf","querySelectorAll","element","getComputedStyle","visibility","offsetParent","firstChild","keydown","ev","stopEvent","preventDefault","stopPropagation","which","contains","target","first","last","shiftKey","version"],"mappings":"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","file":"rmodal.min.js","sourcesContent":["'use strict';\n\nlet is = (obj, type) => Object.prototype.toString.call(obj).toLowerCase() === `[object ${type}]`;\n\nlet addClass = (el, cls) => {\n    let arr = el.className\n    .split(/\\s+/)\n    .filter((c) => !!c && c == cls);\n\n    if (!arr.length) {\n        el.className += ` ${cls}`;\n    }\n};\n\nlet removeClass = (el, cls) => {\n    el.className = el.className\n    .split(/\\s+/)\n    .filter((c) => !!c && c != cls)\n    .join(' ');\n};\n\nclass RModal {\n    constructor(el, opts) {\n        this.opened = false;\n\n        this.opts = {\n            bodyClass: 'modal-open'\n            , dialogClass: 'modal-dialog'\n            , dialogOpenClass: 'bounceInDown'\n            , dialogCloseClass: 'bounceOutUp'\n\n            , focus: true\n            , focusElements: [\n                'a[href]', 'area[href]', 'input:not([disabled]):not([type=hidden])'\n                , 'button:not([disabled])', 'select:not([disabled])'\n                , 'textarea:not([disabled])', 'iframe', 'object', 'embed'\n                , '*[tabindex]', '*[contenteditable]'\n            ]\n\n            , escapeClose: true\n            , content: null\n            , closeTimeout: 500\n        };\n\n        Object.keys(opts || {})\n        .forEach((key) => {\n            /* istanbul ignore else */\n            if (opts[key] !== undefined) {\n                this.opts[key] = opts[key];\n            }\n        });\n\n        this.overlay = el;\n        this.dialog = el.querySelector(`.${this.opts.dialogClass}`);\n\n        if (this.opts.content) {\n            this.content(this.opts.content);\n        }\n    }\n\n    open(content) {\n        this.content(content);\n\n        if (!is(this.opts.beforeOpen, 'function')) {\n            return this._doOpen();\n        }\n\n        this.opts.beforeOpen(() => {\n            this._doOpen();\n        });\n    }\n\n    _doOpen() {\n        addClass(document.body, this.opts.bodyClass);\n\n        removeClass(this.dialog, this.opts.dialogCloseClass);\n        addClass(this.dialog, this.opts.dialogOpenClass);\n\n        this.overlay.style.display = 'block';\n\n        if (this.opts.focus) {\n            this.focusOutElement = document.activeElement;\n            this.focus();\n        }\n\n        if (is(this.opts.afterOpen, 'function')) {\n            this.opts.afterOpen();\n        }\n        this.opened = true;\n    }\n\n    close() {\n        if (!is(this.opts.beforeClose, 'function')) {\n            return this._doClose();\n        }\n\n        this.opts.beforeClose(() => {\n            this._doClose();\n        });\n    }\n\n    _doClose() {\n        removeClass(this.dialog, this.opts.dialogOpenClass);\n        addClass(this.dialog, this.opts.dialogCloseClass);\n\n        removeClass(document.body, this.opts.bodyClass);\n\n        if (this.opts.focus) {\n            this.focus(this.focusOutElement);\n        }\n\n        if (is(this.opts.afterClose, 'function')) {\n            this.opts.afterClose();\n        }\n\n        this.opened = false;\n        setTimeout(() => {\n            this.overlay.style.display = 'none';\n        }, this.opts.closeTimeout);\n    }\n\n    content(html) {\n        if (html === undefined) {\n            return this.dialog.innerHTML;\n        }\n\n        this.dialog.innerHTML = html;\n    }\n\n    elements(selector, fallback) {\n        fallback = fallback || window.navigator.appVersion.indexOf('MSIE 9.0') > -1;\n        selector = is(selector, 'array') ? selector.join(',') : selector;\n\n        return [].filter.call(\n            this.dialog.querySelectorAll(selector)\n            , (element) => {\n                if (fallback) {\n                    var style = window.getComputedStyle(element);\n                    return style.display !== 'none' && style.visibility !== 'hidden';\n                }\n\n                return element.offsetParent !== null;\n            }\n        );\n    }\n\n    focus(el) {\n        el = el || this.elements(this.opts.focusElements)[0] || this.dialog.firstChild;\n\n        if (el && is(el.focus, 'function')) {\n            el.focus();\n        }\n    }\n\n    keydown(ev) {\n        if (this.opts.escapeClose && ev.which == 27) {\n            this.close();\n        }\n\n        function stopEvent() {\n            ev.preventDefault();\n            ev.stopPropagation();\n        }\n\n        if (this.opened && ev.which == 9 && this.dialog.contains(ev.target)) {\n            var elements = this.elements(this.opts.focusElements)\n                , first = elements[0]\n                , last = elements[elements.length - 1];\n\n            if (first == last) {\n                stopEvent();\n            }\n            else if (ev.target == first && ev.shiftKey) {\n                stopEvent();\n                last.focus();\n            }\n            else if (ev.target == last && !ev.shiftKey) {\n                stopEvent();\n                first.focus();\n            }\n        }\n    }\n}\n\nRModal.prototype.version = '@@VERSION@@';\nRModal.version = '@@VERSION@@';\n\nexport default RModal;"]}